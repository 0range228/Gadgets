package com.sec.exploits.CommonsCollections;

import com.sec.annotation.Dependencies;
import org.apache.commons.collections.Transformer;
import org.apache.commons.collections.functors.ChainedTransformer;
import org.apache.commons.collections.functors.ConstantTransformer;
import org.apache.commons.collections.functors.InvokerTransformer;
import org.apache.commons.collections.map.TransformedMap;

import java.util.HashMap;
import java.util.Map;

/**
 * @program: Gadgets
 * @description:
 * @author: 0range
 * @create: 2021-05-11 15:21
 **/

/**
 * Gadget Chain :
*         ObjectInputStream.readObject()
*             AnnotationInvocationHandler.readObject()
*                 Map(Proxy).entrySet()
*                     AnnotationInvocationHandler.invoke()
*                         LazyMap.get()
*                             ChainedTransformer.transform()
*                                 ConstantTransformer.transform()
*                                 InvokerTransformer.transform()
*                                     Method.invoke()
*                                         Class.getMethod()
*                                 InvokerTransformer.transform()
*                                     Method.invoke()
*                                         Runtime.getRuntime()
*                                 InvokerTransformer.transform()
*                                     Method.invoke()
*                                         Runtime.exec()
 */

@Dependencies({
        "commons-collections:3.1",
        "jdk_1.7"
})
public class CommonsCollections1_LazyMap_Exploit {
    public static void main(String[] args) {
    }
}
