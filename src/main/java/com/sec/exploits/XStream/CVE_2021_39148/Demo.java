package com.sec.exploits.XStream.CVE_2021_39148;

import java.io.*;

/**
 * @program: Gadgets
 * @description:
 * @author: 0range
 * @create: 2021-09-03 20:36
 **/


public class Demo {
    public static void main(String[] args) throws Exception {
        Person p = new Person();
        p.name = "Jack";

        // 序列化
        ObjectOutputStream oos = new ObjectOutputStream(new FileOutputStream("demo.ser"));
        oos.writeObject(p);
        oos.close();

        //反序列化
        ObjectInputStream ois = new ObjectInputStream(new FileInputStream("demo.ser"));
        Person o = (Person)ois.readObject();
        ois.close();

    }

    static class Person implements Serializable {
        public String name;
        private void readObject(java.io.ObjectInputStream in) throws Exception{
            in.defaultReadObject();
            Runtime.getRuntime().exec("open /Applications/Calculator.app");
        }
    }
}
