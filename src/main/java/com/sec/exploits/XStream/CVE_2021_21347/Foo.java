package com.sec.exploits.XStream.CVE_2021_21347;

import com.thoughtworks.xstream.XStream;

/**
 * @program: Gadgets
 * @description:
 * @author: 0range
 * @create: 2021-08-07 19:27
 **/


class Foo {
    private String foocontent;
    private Bar bar;

    public String getFoocontent() {
        return foocontent;
    }

    public void setFoocontent(String foocontent) {
        this.foocontent = foocontent;
    }

    public Bar getBar() {
        return bar;
    }

    public void setBar(Bar bar) {
        this.bar = bar;
    }

    class Bar {
        private String blabla;

        public String getBlabla() {
            return blabla;
        }

        public void setBlabla(String blabla) {
            this.blabla = blabla;
        }

    }

    public static void main(String[] args) {
        Foo foo = new Foo();
        Bar bar = foo.new Bar();
        bar.setBlabla("hello");
        foo.setBar(bar);
        XStream xstream = new XStream();
        String xml = xstream.toXML(foo);
        System.out.println(xml);
    }

}
